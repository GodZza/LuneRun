# 核心玩法测试使用指南

## 概述
`CoreGameplayTest.cs` 是一个完整的核心玩法测试脚本，用于验证游戏的基本功能。

## 测试内容
1. **玩家移动（加速）** - 按住空格键加速
2. **跳跃功能** - 松开空格键跳跃
3. **重力效果** - 玩家会受重力影响下落
4. **碰撞检测** - 玩家会与轨道碰撞并停留在轨道上
5. **收集物品** - 玩家可以收集SpeedEntity获得加速
6. **死亡判定** - 玩家掉出轨道会死亡

## 如何使用

### 方法1：在Unity编辑器中配置
1. 在Unity编辑器中打开任意现有测试场景（如 `PureDynamicTrackTest.unity`）
2. 在Scene中创建一个空GameObject，命名为 `CoreGameplayTestRunner`
3. 将 `CoreGameplayTest.cs` 脚本拖拽到这个GameObject上
4. 在Inspector面板中，设置参数：
   - `Auto Run On Start`: 勾选（启动时自动运行测试）
   - `Test Level Id`: 设置为测试的关卡ID（默认为1）
   - `Test Duration`: 测试持续时间（秒，默认为30）
5. 运行场景

### 方法2：快速运行测试
由于场景配置需要手动操作，建议先使用以下方法快速验证：

#### 创建简单测试场景（推荐）
```csharp
// 在Unity编辑器中执行以下步骤：
// 1. File -> New Scene
// 2. 点击GameObject -> Create Empty
// 3. 重命名为 "CoreGameplayTestRunner"
// 4. 拖拽 CoreGameplayTest.cs 到该GameObject
// 5. 点击Play运行
```

## 测试操作
- **T键** - 开始测试
- **ESC键** - 结束测试
- **空格键** - 加速（按住） / 跳跃（松开）
- **GUI界面** - 显示实时测试数据

## 测试结果判定
测试通过条件：
- ✅ 玩家未死亡
- ✅ 最大速度 > 0
- ✅ 移动距离 > 10

测试失败条件：
- ❌ 玩家死亡（掉出轨道）
- ❌ 最大速度 = 0（无法移动）
- ❌ 移动距离 < 10（移动不足）

## 预期输出
测试完成后，会在控制台输出完整测试报告（一次性输出，方便复制）：

### 测试失败时（完整报告）
```

╔═══════════════════════════════════════════════════════════════╗
║                   核心玩法测试完整报告                          ║
╚═══════════════════════════════════════════════════════════════╝

【测试配置】
  Level ID: 1
  测试时长: 30 秒
  实际时长: 5.23 秒

【测试结果】
  状态: 测试失败
  跳跃次数: 0
  落地次数: 0
  最大速度: 0.00
  移动距离: 0.00
  玩家死亡: True

【位置信息】
  起始位置: (0.00, 1.00, 0.00)
  结束位置: (0.00, -5.00, 10.00)

【错误列表】(3 个错误)
  [1] [5.23] [死亡] 玩家死亡，位置: (0.00, -5.00, 10.00)
  [2] [5.23] [致命错误] 玩家死亡，测试失败！
  [3] [5.23] - 玩家死亡：玩家掉出了轨道或发生了致命错误

【详细日志】(XX 条记录)
  1. [0.00] ========== 核心玩法测试场景 ==========
  2. [0.00] 初始化测试环境...
  3. [0.05] [1/5] 创建测试 Level (LevelId: 1)
  ...

╔═══════════════════════════════════════════════════════════════╗
║                      报告结束                                   ║
╚═══════════════════════════════════════════════════════════════╝
```

## 常见问题

### 问题1：无法看到玩家
- 确保场景中有Main Camera
- 确保Main Camera的位置正确（建议在玩家后方）
- 确保Level.Initialize() 已正确调用

### 问题2：玩家无法移动
- 检查Player.Tick() 是否在Level.Update()中被调用
- 检查轨道是否正确生成
- 检查Input系统是否正常工作

### 问题3：玩家立即死亡
- 检查轨道是否正确加载
- 检查玩家初始位置是否在轨道上方
- 检查DynamicTrack是否正常工作

## 下一步
测试通过后，可以继续验证：
1. 不同LevelId的游戏体验
2. 生成器的多样性
3. 性能测试
4. 边界条件测试
